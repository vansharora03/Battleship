(()=>{"use strict";const t=function(t=null){return{length:t,hits:0,hit:function(){this.isSunk()||this.hits++},isSunk:function(){return this.hits>=this.length}}},e=function(){const t={board:function(t){let e=[];for(let t=0;t<7;t++){e[t]=[];for(let a=0;a<7;a++)e[t][a]={ship:null,tried:!1}}return e}(),ships:[],placeShip:function(t,e,a,n=!1){let r=[t,e];if(n){t+a.length-1>=7&&(r=[7-a.length,e]);let n=r[1],o=r[0];for(let t=0;t<a.length;t++)if(this.board[n][o+t].ship)return!1;this.ships.push(a);for(let t=0;t<a.length;t++)this.board[n][o+t].ship=a}else{e+a.length-1>=7&&(r=[t,7-a.length]);let n=r[1],o=r[0];for(let t=0;t<a.length;t++)if(this.board[n+t][o].ship)return!1;this.ships.push(a);for(let t=0;t<a.length;t++)this.board[n+t][o].ship=a}return!0},receiveAttack:function(t,e){let a=this.board[e][t];return!a.tried&&(a.tried=!0,null!==a.ship&&a.ship.hit(),!0)},lost:function(){return this.ships.every((t=>t.isSunk()))}},e=new Set,a=function(t,a){e.has(this.opponent.gameboard.board[a][t])||(this.opponent.gameboard.receiveAttack(t,a),e.add(this.opponent.gameboard.board[a][t]))},n=function(t){return Math.floor(Math.random()*t)},r=function(t=n){let o=t(7),s=t(7);e.has(this.opponent.gameboard.board[s][o])?r.call(this,t):(a.call(this,o,s),e.add(this.opponent.gameboard.board[s][o]))};return{gameboard:t,opponent:null,attack:a,computerAttack:r}},a=document.querySelector(".content"),n=document.querySelector(".startGameBtn"),r=function(a){const n=e(),r=e();n.opponent=r,r.opponent=n;let o=n;const s=function(t){const e=t==n?".user-board-square":".computer-board-square";document.querySelectorAll(e).forEach((e=>{const a=t.gameboard.board[parseInt(e.dataset.y)][parseInt(e.dataset.x)];null!==a.ship?(e.classList.add("ship"),a.tried&&(e.classList.remove("ship"),e.classList.add("damaged-ship"))):a.tried&&e.classList.add("missed")}))},d=function(t){let e=t.opponent;const a=e==n?".user-board-square":".computer-board-square";document.querySelectorAll(a).forEach((a=>{a.addEventListener("click",(()=>{if(o!==t)return;let n=e.gameboard.receiveAttack(parseInt(a.dataset.x),parseInt(a.dataset.y));s(e),!0===n&&(o=e)}))}))};return{setUpUserBoard:function(){const t=document.createElement("div");t.classList.add("user-board");for(let e=0;e<n.gameboard.board.length;e++)for(let a=0;a<n.gameboard.board[e].length;a++){const n=document.createElement("div");n.classList.add("user-board-square"),n.dataset.x=a,n.dataset.y=e,t.appendChild(n)}a.appendChild(t)},setUpComputerBoard:function(){const t=document.createElement("div");t.classList.add("computer-board");for(let e=0;e<r.gameboard.board.length;e++)for(let a=0;a<r.gameboard.board[e].length;a++){const n=document.createElement("div");n.classList.add("computer-board-square"),n.dataset.x=a,n.dataset.y=e,t.appendChild(n)}a.appendChild(t)},startGame:function(){!function(){const e=new t(2),a=new t(3),r=new t(5);n.gameboard.placeShip(0,0,e),n.gameboard.placeShip(3,1,a),n.gameboard.placeShip(2,5,r,!0),s(n)}(),function(){const e=new t(2),a=new t(3),n=new t(5);r.gameboard.placeShip(0,0,e),r.gameboard.placeShip(3,1,a),r.gameboard.placeShip(2,5,n,!0),s(r)}(),d(n),d(r)}}}(a);r.setUpUserBoard(),r.setUpComputerBoard(),n.addEventListener("click",(()=>{r.startGame()}))})();